\documentclass[a4paper,10pt]{article}
\usepackage[empty]{fullpage}
\usepackage[english]{babel}
\usepackage{listings}

\title{ADDIS excel/table study data export}
\author{J.J. de Keijser}
\begin{document}
\maketitle
\section*{ADDIS study export}
Also have a look at \texttt{excelExportExample.xlsx}. This Excel file contains an example of a study export. Having a look at it while reading this document might give greater insight into the format.\\
Fixed headers are shown in \textbf{bold}.\\
References are shown in \textit{italic} e.g. `=Concepts!B2'.\\
Fields marked by a * will not be used when importing a study.

\subsection*{Study Data}
To easier grasp the \texttt{Study data} sheet the sheet is explained in bloks. Each blok corresponds to a header in the first row of the sheet.

\subsubsection*{Study Information}
The \texttt{Study information} blok contains global information about the study. See table \ref{table:Study Information}.
\begin{table}[h]
  \small
  \centering
  \caption{Study information}
  \label{table:Study Information}
  \begin{tabular}{|l|l|l|l|l|l|l|l|}
    \hline
    \multicolumn{8}{|l|}{Study Information} \\ \hline
    \multicolumn{8}{|l|}{}                  \\ \hline
    \textbf{ID} & \textbf{addis url} & \textbf{title} & \textbf{group allocation} & \textbf{blinding} & \textbf{status} & \textbf{number of centers} & \textbf{objective} \\ \hline
    text* & URL* & text & text & text & text & number & text \\ \hline
  \end{tabular}
\end{table}

\subsubsection*{Population information}
The \texttt{Population information} blok contains then indication and eligibility criteria of the study. See table \ref{table:Population information}.
\begin{table}[h]
  \centering
  \caption{Population information}
  \label{table:Population information}
  \begin{tabular}{|l|l|}
    \hline
    \multicolumn{2}{|l|}{\textbf{Population information}} \\ \hline
    \multicolumn{2}{|l|}{}                                \\ \hline
    \textbf{indication} & \textbf{eligibility criteria}   \\ \hline
    text & text                                           \\ \hline
  \end{tabular}
\end{table}

\subsubsection*{Arm information}
The \texttt{Arm information} blok contains the title and description of each arm in the study. See table \ref{table:Arm information}.
\begin{table}[h]
  \centering
  \caption{Arm information}
  \label{table:Arm information}
  \begin{tabular}{|l|l|}
    \hline
    \multicolumn{2}{|l|}{\textbf{Arm information}}  \\ \hline
    \multicolumn{2}{|l|}{}                          \\ \hline
    \textbf{title} & \textbf{description}           \\ \hline
    text (arm 1)& text                              \\ \hline
    ... & ...                                       \\ \hline
    text (arm n)& text                              \\ \hline
  \end{tabular}
\end{table}

\subsubsection*{Measurement data}
The \texttt{Measurement data} blok contains the measurements for each outcome measured in the study. The \textit{variable name} cell contains a reference to the study concept of that variable. The \textit{variable name} blok is repeated for every variable measured in the study. Below each \textit{variable name} column, there is the \textbf{variable type} field, \textbf{measurement type} field, and a \textbf{measurement moment} blok. The \textbf{measurement moment} blok is repeated for every measurement moment in the study. It contains the moment itself, and columns with values for each measured result property-arm combination.
See table \ref{table:Measurement data}.
\begin{table}[h]
  \centering
  \caption{Measurement data}
  \small
  \label{table:Measurement data}
  \begin{tabular}{|l|l|l|l|l|l|}
    \hline
    \multicolumn{6}{|l}{\textbf{Measurement data}}  \\ \hline
    \multicolumn{6}{|l|}{\textit{variable name}}    \\ \hline
    \textbf{variable type} &\textbf{ measurement type} & \textbf{measurement moment} & result property 1 &  ... & result property n \\ \hline
    text & text & text & value & ... & value        \\  \cline{4-6} 
         &      &      & ...   & ... & ...          \\  \cline{4-6} 
         &      &      & value & ... & value        \\ \hline
  \end{tabular}
\end{table}

\subsection*{Activities}
The layout of the \texttt{Activities} worksheet can be seen in table \ref{table:Activities}.
\begin{table}[h]
  \centering
  \caption{Activities}
  \small
  \label{table:Activities}
  \begin{tabular}{|l|l|l|l|l|l|l|l|l|l|}
    \hline
    \textbf{id}      & \textbf{title} & \textbf{type} & \textbf{description} & \textbf{drug label}   & \textbf{dose type} & \textbf{dose} & \textbf{max dose} & \textbf{unit} & \textbf{periodicity} \\ \hline
    URI (activity 1) & text           & text          & value                & \textit{drug concept} & text               & value         & value             & text          & duration             \\ \hline
    ...              & ...            & ...           & ...                  & ...                   & ...                & ...           & ...               & ...           & ...                  \\ \hline
    URI (activity n) & text           & text          & value                & \textit{drug concept} & text               & value         & value             & text          & duration             \\ \hline
  \end{tabular}
\end{table}

\subsection*{Epochs}
The layout of the \texttt{Epochs} worksheet can be seen in table \ref{table:Epochs}.
\begin{table}[!h]
  \centering
  \caption{Epochs}
  \label{table:Epochs}
  \begin{tabular}{|l|l|l|l|l|}
    \hline
    \textbf{id} & \textbf{name} & \textbf{description} & \textbf{duration} & \textbf{isPrimary} \\ \hline
    URI (epoch 1)& text           & text                 & duration                & boolean  \\ \hline
    ...         & ...          & ...                 & ...                & ...  \\ \hline
    URI (epoch n)& text           & text                 & duration                & boolean  \\ \hline
  \end{tabular}
\end{table}

\subsection*{Study design}
The layout of the \texttt{Study design} worksheet can be seen in table \ref{table:Study design}.
\begin{table}[!h]
  \centering
  \caption{Study design}
  \label{table:Study design}
  \begin{tabular}{|l|l|l|l|}
    \hline
    \textbf{arm}   & \textit{arm 1}    & ...               & \textit{arm n}    \\ \hline
    \textit{arm 1} & \textit{activity} & \textit{activity} & \textit{activity} \\ \hline
    ...            & \textit{activity} & \textit{activity} & \textit{activity} \\ \hline
    \textit{arm m} & \textit{activity} & \textit{activity} & \textit{activity} \\ \hline
  \end{tabular}
\end{table}

\subsection*{Measurement moments}
The layout of the \texttt{Measurement moment} worksheet can be seen in table \ref{table:Measurement moments}.
\begin{table}[!h]
  \centering
  \caption{Measurement moments}
  \label{table:Measurement moments}
  \begin{tabular}{|l|l|l|l|l|}
    \hline
    \textbf{id} & \textbf{name} & \textbf{epoch} & \textbf{from} & \textbf{offset} \\ \hline
    URI         & text          & \textit{epoch} & end/start     & duration        \\ \hline
    ...         & ...           & ...            &  ...          & ...             \\ \hline
    URI         & text          & \textit{epoch} & end/start     & duration        \\ \hline
  \end{tabular}
\end{table}

\subsection*{Concepts}
The layout of the \texttt{Concepts} worksheet can be seen in table \ref{table:Concepts}. Note that the \textbf{dataset concept uri} and \textbf{multiplier} columns are only relevant for dataset exports.
\begin{table}[!h]
  \centering
  \caption{Concepts}
  \label{table:Concepts}
  \begin{tabular}{|l|l|l|l|l|}
    \hline
    \textbf{id} & \textbf{label} & \textbf{type} & \textbf{dataset concept uri} & \textbf{multiplier} \\ \hline
    URI         & text           & text          & URI                          & value               \\ \hline
    ...         & ...            & ...           & ...                          & ...                 \\ \hline
    URI         & text           & text          & URI                          & value               \\ \hline
  \end{tabular}
\end{table}

\section*{Dataset export}
The dataset export file has the same structure as that of the study export. However, there is data for multiple studies per worksheet, and there are two extra worksheets with additional dataset information, \texttt{Dataset information} and \texttt{Dataset concepts}. In each original sheet, each study is separated by a row of white space. In all but the \texttt{Study data} sheet, the data for a study is preceeded by a \textit{reference} to the id of the corresponding study.\\
In order to handle studies that measure difference variable we let each study have its own variables. We currently do not harmonise across the entire dataset. In the future options such as concept selection might considered.

\subsection*{Dataset information}
The layout of the \texttt{Dataset information} worksheet can be seen in table \ref{table:Dataset information}.
\begin{table}[!h]
  \centering
  \caption{Dataset information}
  \label{table:Dataset information}
  \begin{tabular}{|l|l|l|}
    \hline
    \textbf{title} & \textbf{ADDIS url} & \textbf{description} \\ \hline
    text           & URL                & text                 \\ \hline
  \end{tabular}
\end{table}

\subsection*{Dataset concepts}
The layout of the \texttt{Dataset concepts} worksheet can be seen in table \ref{table:Dataset concepts}.
\begin{table}[!h]
  \centering
  \caption{Dataset concepts}
  \label{table:Dataset concepts}
  \begin{tabular}{|l|l|l|}
    \hline
    \textbf{id} & \textbf{label} & \textbf{type} \\ \hline
    URI         & text           & text          \\ \hline
    ...         & ...            & ...           \\ \hline
    URI         & text           & text          \\ \hline
  \end{tabular}
\end{table}

\end{document}          
